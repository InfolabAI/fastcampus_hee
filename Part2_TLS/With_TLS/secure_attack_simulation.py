#!/usr/bin/env python3
"""
===========================================
TLS μ•”νΈν™” λ°©μ–΄ ν¨κ³Ό μ‹μ—°
===========================================

κ°•μ λ©μ :
μ΄ νμΌμ€ HTTP κ³µκ²©μ΄ HTTPS/TLS ν™κ²½μ—μ„ μ–΄λ–»κ² λ¬΄λ ¥ν™”λλ”μ§€ μ‹μ—°ν•©λ‹λ‹¤.
No_TLS λ””λ ‰ν† λ¦¬μ attack_simulation.pyμ™€ λ€λΉ„ν•μ—¬ λ³΄μ•μ μ°¨μ΄λ¥Ό ν™•μΈν•©λ‹λ‹¤.

ν•™μµ ν¬μΈνΈ:
1. TLS μ•”νΈν™”μ λ°©μ–΄ ν¨κ³Ό
2. λ„¤νΈμ›ν¬ μ¤λ‹ν•‘ κ³µκ²© λ°©μ–΄
3. MITM(μ¤‘κ°„μ κ³µκ²©) λ°©μ–΄
4. TLS μΈμ¦μ„ κ²€μ¦ λ©”μ»¤λ‹μ¦
5. μ „μ†΅ λ λ²¨ λ³΄μ•μ μ¤‘μ”μ„±
6. HTTP vs HTTPS λ³΄μ• λΉ„κµ

λ³΄μ• κ°λ…:
- μ „μ†΅ λ λ²¨ λ³΄μ• (Transport Layer Security)
  * λ„¤νΈμ›ν¬ κ³„μΈµμ—μ„ λ¨λ“  λ°μ΄ν„° μ•”νΈν™”
  * μ• ν”λ¦¬μΌ€μ΄μ… μΈμ¦κ³Ό λ…λ¦½μ 
  * HTTP κ³µκ²©μ„ μ›μ² μ°¨λ‹¨

- TLS λ³΄μ• λ©”μ»¤λ‹μ¦:
  * λ°μ΄ν„° μ•”νΈν™”: λ‚΄μ© λ³΄νΈ
  * μ„λ²„ μΈμ¦: μ‹ μ› ν™•μΈ
  * λ¬΄κ²°μ„± λ³΄μ¥: λ³€μ΅° λ°©μ§€
  * Perfect Forward Secrecy: κ³Όκ±° ν†µμ‹  λ³΄νΈ

λ€λΉ„:
- attack_simulation.py (No_TLS): HTTP κ³µκ²© μ„±κ³µ
- secure_attack_simulation.py (μ΄ νμΌ): HTTPSλ΅ κ³µκ²© λ°©μ–΄

μ¤‘μ” λ©”μ‹μ§€:
μ΄ μ‹μ—°μ€ κµμ΅ λ©μ μ…λ‹λ‹¤. μ‹¤μ  κ³µκ²©μ— μ‚¬μ©ν•μ§€ λ§μ„Έμ”.
"""

# ===========================================
# ν•„μ”ν• λΌμ΄λΈλ¬λ¦¬ μ„ν¬νΈ
# ===========================================

import requests  # HTTP μ”μ²­ λΌμ΄λΈλ¬λ¦¬
import time      # μ‹κ°„ μ²λ¦¬
import json      # JSON λ°μ΄ν„° μ²λ¦¬

# ===========================================
# TLS λ°©μ–΄ ν¨κ³Ό μ‹μ—° ν΄λμ¤
# ===========================================

class SSLDefenseDemo:
    """
    TLSμ μ¤λ‹ν•‘/MITM λ°©μ–΄ ν¨κ³Ό μ‹μ—°

    λ©μ : HTTP κ³µκ²©μ΄ HTTPSμ—μ„ μ‹¤ν¨ν•λ” κ²ƒμ„ λ³΄μ—¬μ¤

    λ€λΉ„ κµ¬μ΅°:
    - No_TLS/attack_simulation.py: HTTP κ³µκ²© μ„±κ³µ
    - With_TLS/secure_attack_simulation.py: HTTPS κ³µκ²© μ‹¤ν¨

    μ‹μ—° ν•­λ©:
    1. λ„¤νΈμ›ν¬ μ¤λ‹ν•‘ λ°©μ–΄
    2. MITM κ³µκ²© λ°©μ–΄
    3. μΈμ¦μ„ κ²€μ¦ λ©”μ»¤λ‹μ¦

    κµμ΅μ  κ°€μΉ:
    - HTTP vs HTTPSμ μ‹¤μ§μ  μ°¨μ΄
    - TLSμ μ‹¤μ  λ°©μ–΄ ν¨κ³Ό
    - λ³΄μ• μ„¤μ •μ μ¤‘μ”μ„±
    """

    def __init__(self, target_url="https://127.0.0.1:8444"):
        """
        μ΄κΈ°ν™” λ©”μ„λ“

        νλΌλ―Έν„°:
        - target_url: λ€μƒ HTTPS μ„λ²„ URL (κΈ°λ³Έ: ν•μ΄λΈλ¦¬λ“ μ„λ²„)

        URL μ„ νƒ:
        - https://127.0.0.1:8443: μμ FastMCP HTTPS μ„λ²„
        - https://127.0.0.1:8444: ν•μ΄λΈλ¦¬λ“ FastAPI + FastMCP μ„λ²„

        λ³΄μ• μ£Όμ:
        - λ°λ“μ‹ https:// μ‚¬μ©
        - http://λ¥Ό μ‚¬μ©ν•λ©΄ TLS λ³΄νΈ μ—†μ
        """
        self.target_url = target_url
        
    def test_sniffing_defense(self):
        """
        TLS μ•”νΈν™”λ΅ λ„¤νΈμ›ν¬ μ¤λ‹ν•‘ λ°©μ–΄ μ‹μ—°

        λ©μ : TLSκ°€ μ¤λ‹ν•‘ κ³µκ²©μ„ μ–΄λ–»κ² λ°©μ–΄ν•λ”μ§€ λ³΄μ—¬μ¤

        μ‹μ—° νλ¦„:
        1. λ―Όκ°ν• λ°μ΄ν„°λ¥Ό HTTPSλ΅ μ „μ†΅
        2. κ³µκ²©μκ°€ λ„¤νΈμ›ν¬μ—μ„ ν¨ν‚· μΊ΅μ² (μ‹λ®¬λ μ΄μ…)
        3. μΊ΅μ²ν• ν¨ν‚·μ—μ„ ν‰λ¬Έ κ²€μƒ‰ μ‹λ„
        4. TLS μ•”νΈν™”λ΅ λ°μ΄ν„° λ³΄νΈ ν™•μΈ

        HTTP vs HTTPS λΉ„κµ:
        - HTTP: ν¨ν‚·μ—μ„ "admin", "password" ν‰λ¬ΈμΌλ΅ λ°κ²¬
        - HTTPS: ν¨ν‚·μ΄ μ•”νΈν™”λμ–΄ λ‚΄μ© ν•΄λ… λ¶κ°€

        λ³΄μ• λ©”μ»¤λ‹μ¦:
        - TLS ν•Έλ“μ…°μ΄ν¬λ΅ μ•”νΈν™” ν‚¤ κµν™
        - AES-256-GCM λ“± κ°•λ ¥ν• μ•”νΈν™” μ•κ³ λ¦¬μ¦
        - λ¨λ“  μ• ν”λ¦¬μΌ€μ΄μ… λ°μ΄ν„° μ•”νΈν™”
        - ν¨ν‚· μΊ΅μ²ν•΄λ„ λ‚΄μ© μ• μ μ—†μ

        μ‹¤μ  κ³µκ²© λ„κµ¬:
        - Wireshark, tcpdumpλ΅ ν¨ν‚· μΊ΅μ² κ°€λ¥
        - ν•μ§€λ§ TLS μ•”νΈν™”λ λ‚΄μ©μ€ ν•΄λ… λ¶κ°€
        - TLS ν‚¤ μ—†μ΄λ” λ³µνΈν™” λ¶κ°€λ¥
        """
        print("π” 1λ‹¨κ³„: TLS μ•”νΈν™” - λ„¤νΈμ›ν¬ μ¤λ‹ν•‘ λ°©μ–΄")
        print("=" * 50)
        print("π’΅ TLSλ” λ¨λ“  λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•μ—¬ μ¤λ‹ν•‘ κ³µκ²©μ„ λ¬΄λ ¥ν™”ν•©λ‹λ‹¤")

        # λ―Όκ°ν• λ°μ΄ν„° μ¤€λΉ„
        # HTTPμ—μ„λ” μ΄ λ°μ΄ν„°κ°€ ν‰λ¬ΈμΌλ΅ μ „μ†΅λμ–΄ μ¤λ‹ν•‘ κ°€λ¥
        # HTTPSμ—μ„λ” TLS μ•”νΈν™”λ΅ λ³΄νΈ
        sensitive_data = {
            "jsonrpc": "2.0",
            "method": "tools/call",
            "params": {
                "name": "login",
                "arguments": {
                    "username": "admin",
                    "password": "TopSecret123!",
                    "credit_card": "4532-1234-5678-9012"
                }
            },
            "id": 1
        }
        
        print("π“¤ μ „μ†΅ν•λ” λ―Όκ°ν• λ°μ΄ν„°:")
        print(f"   μ‚¬μ©μλ…: {sensitive_data['params']['arguments']['username']}")
        print(f"   λΉ„λ°€λ²νΈ: {sensitive_data['params']['arguments']['password']}")
        print(f"   μΉ΄λ“λ²νΈ: {sensitive_data['params']['arguments']['credit_card']}")
        
        try:
            print("\nπ“΅ TLS μ•”νΈν™”λ΅ λ°μ΄ν„° μ „μ†΅ μ¤‘...")
            response = requests.post(
                f"{self.target_url}/mcp",
                json=sensitive_data,
                verify=False,  # μμ²΄ μ„λ… μΈμ¦μ„ (λ°λ¨μ©)
                timeout=5
            )
            print("   β… TLS μ•”νΈν™” μ „μ†΅ μ™„λ£")
        except Exception as e:
            print(f"   β οΈ μ—°κ²° λ¬Έμ : {type(e).__name__}")
        
        print("\nπ•µοΈ κ³µκ²©μκ°€ λ„¤νΈμ›ν¬μ—μ„ μΊ΅μ²ν• κ²ƒ:")
        
        # μ‹¤μ  TLS μ•”νΈν™” ν¨ν‚· μ‹λ®¬λ μ΄μ…
        captured_packets = [
            b'\x16\x03\x03\x00\x9a\x01\x00\x00\x96\x03\x03',  # Client Hello
            b'\x17\x03\x03\x01\x20\xa7\x93\x5f\x2e\x8b\x4c',  # Encrypted Data
            b'\x17\x03\x03\x00\x40\x1b\xf8\x7c\x42\x3d\x91'   # More Encrypted Data
        ]
        
        for i, packet in enumerate(captured_packets, 1):
            hex_data = packet.hex()
            formatted = ' '.join(hex_data[j:j+2] for j in range(0, len(hex_data), 2))
            print(f"   ν¨ν‚· {i}: {formatted[:40]}...")
        
        print("\nπ” λ―Όκ°ν• λ°μ΄ν„° κ²€μƒ‰ μ‹λ„:")
        search_terms = ["admin", "TopSecret123", "4532-1234-5678-9012"]
        
        for term in search_terms:
            found = False
            for packet in captured_packets:
                if term.encode() in packet:
                    found = True
                    break
            
            if found:
                print(f"   β '{term}' λ°κ²¬ - ν‰λ¬Έ λ…Έμ¶!")
            else:
                print(f"   β… '{term}' μ—†μ - μ•”νΈν™”λ΅ λ³΄νΈλ¨")
        
        print("\nβ… κ²°λ΅ : νΈλν”½μ€ μΊ΅μ²λμ§€λ§ TLS μ•”νΈν™”λ΅ λ‚΄μ© ν•΄λ… λ¶κ°€!")

    def test_mitm_defense(self):
        """
        TLS μΈμ¦μ„ κ²€μ¦μΌλ΅ MITM κ³µκ²© λ°©μ–΄ μ‹μ—°

        λ©μ : TLS μΈμ¦μ„ κ²€μ¦μ΄ MITM κ³µκ²©μ„ μ–΄λ–»κ² μ°¨λ‹¨ν•λ”μ§€ λ³΄μ—¬μ¤

        MITM κ³µκ²© μ‹λ‚λ¦¬μ¤:
        1. κ³µκ²©μκ°€ λ„¤νΈμ›ν¬ μ¤‘κ°„μ— κ°€μ§ ν”„λ΅μ‹ μ„¤μΉ
        2. ν”Όν•΄μμ νΈλν”½μ„ ν”„λ΅μ‹λ΅ μ°ν
        3. ν”„λ΅μ‹κ°€ μμ²΄ μ„λ…ν• κ°€μ§ μΈμ¦μ„ μ κ³µ
        4. ν΄λΌμ΄μ–ΈνΈκ°€ μΈμ¦μ„ κ²€μ¦μΌλ΅ κ°€μ§ μ„λ²„ νƒμ§€

        μΈμ¦μ„ κ²€μ¦ λ©”μ»¤λ‹μ¦:
        - verify=True: μΈμ¦μ„ μ²΄μΈ κ²€μ¦ (μ•μ „)
          * CA μΈμ¦μ„λ΅ μ„λ²„ μΈμ¦μ„ κ²€μ¦
          * μΈμ¦μ„ λ§λ£ ν™•μΈ
          * λ„λ©”μΈ μ΄λ¦„ μΌμΉ ν™•μΈ
          * μ¤‘κ°„ κ³µκ²© νƒμ§€

        - verify=False: μΈμ¦μ„ κ²€μ¦ μƒλµ (μ„ν—)
          * λ¨λ“  μΈμ¦μ„ μλ½
          * MITM κ³µκ²©μ— μ™„μ „ λ…Έμ¶
          * κ°λ°/ν…μ¤νΈμ©μΌλ΅λ§ μ‚¬μ©
          * ν”„λ΅λ•μ…μ—μ„λ” μ λ€ μ‚¬μ© κΈμ§€

        HTTP vs HTTPS:
        - HTTP: μΈμ¦μ„ μ—†μ, MITM κ³µκ²© μ„±κ³µ
        - HTTPS (verify=True): μΈμ¦μ„ κ²€μ¦μΌλ΅ MITM νƒμ§€
        - HTTPS (verify=False): MITM κ³µκ²© μ„±κ³µ (μλ»λ μ„¤μ •)

        μ‹¤μ  κ³µκ²© λ„κµ¬:
        - mitmproxy, Burp Suite, Fiddler
        - κ°€μ§ μΈμ¦μ„ λ°κΈ‰
        - νΈλν”½ κ°€λ΅μ±„κΈ° λ° λ³€μ΅°
        - ν•μ§€λ§ verify=Trueλ΅ νƒμ§€ κ°€λ¥
        """
        print("\n\nπ•µοΈ 2λ‹¨κ³„: TLS μΈμ¦μ„ κ²€μ¦ - μ¤‘κ°„μ κ³µκ²© λ°©μ–΄")
        print("=" * 50)
        print("π’΅ TLS μΈμ¦μ„ κ²€μ¦μΌλ΅ κ°€μ§ μ„λ²„λ¥Ό νƒμ§€ν•κ³  MITM κ³µκ²©μ„ μ°¨λ‹¨ν•©λ‹λ‹¤")
        
        print("π“‹ MITM κ³µκ²© μ‹λ‚λ¦¬μ¤:")
        print("   1. κ³µκ²©μκ°€ κ°€μ§ HTTPS ν”„λ΅μ‹ μ„¤μΉ")
        print("   2. ν”Όν•΄μ νΈλν”½μ„ ν”„λ΅μ‹λ΅ μ°ν")
        print("   3. ν”„λ΅μ‹κ°€ κ°€μ§ μΈμ¦μ„ μ κ³µ")
        print("   4. TLS μΈμ¦μ„ κ²€μ¦μΌλ΅ κ°€μ§ μ„λ²„ νƒμ§€")
        
        print("\nπ”’ μΈμ¦μ„ κ²€μ¦ ON (μ•μ „ν• μ„¤μ •):")
        try:
            response = requests.get(f"{self.target_url}/health", verify=True, timeout=3)
            print("   β οΈ μμƒμΉ λ»ν• μ„±κ³µ - κ³µμΈ μΈμ¦μ„ μ„¤μΉλ¨")
        except requests.exceptions.SSLError as e:
            print("   β… TLS μΈμ¦μ„ κ²€μ¦ μ‹¤ν¨!")
            print(f"      μ¤λ¥: {type(e).__name__}")
            print("   π›΅οΈ MITM κ³µκ²©μ΄ μΈμ¦μ„ κ²€μ¦μΌλ΅ νƒμ§€λ¨")
        except Exception as e:
            print(f"   β μ—°κ²° μ¤λ¥: {type(e).__name__}")
        
        print("\nβ οΈ μΈμ¦μ„ κ²€μ¦ OFF (μ„ν—ν• μ„¤μ •):")
        try:
            response = requests.get(f"{self.target_url}/health", verify=False, timeout=3)
            if response.status_code == 200:
                print("   π¨ μ—°κ²° μ„±κ³µ - ν•μ§€λ§ MITM κ³µκ²©μ— μ™„μ „ λ…Έμ¶!")
                print("   π’¥ κ³µκ²©μκ°€ λ¨λ“  νΈλν”½μ„ κ°€λ΅μ±„κ³  λ³€μ΅° κ°€λ¥")
                print("   β οΈ μ‹¤μ  μ΄μμ—μ„λ” μ λ€ μ‚¬μ© κΈμ§€!")
            else:
                print(f"   β μ—°κ²° μ‹¤ν¨: HTTP {response.status_code}")
        except Exception as e:
            print(f"   β μ—°κ²° μ‹¤ν¨: {type(e).__name__}")
        
        print("\nβ… κ²°λ΅ : TLS μΈμ¦μ„ κ²€μ¦μΌλ΅ MITM κ³µκ²© νƒμ§€ λ° μ°¨λ‹¨!")
    
    def show_defense_summary(self):
        """TLS λ°©μ–΄ ν¨κ³Ό μ”μ•½"""
        print("\n\nπ“ TLS μ•”νΈν™” λ°©μ–΄ ν¨κ³Ό μ”μ•½")
        print("=" * 50)
        
        print("π” λ„¤νΈμ›ν¬ μ¤λ‹ν•‘:")
        print("   HTTP       : β ν‰λ¬Έ λ°μ΄ν„° μ™„μ „ λ…Έμ¶")
        print("   HTTPS/TLS  : β… μ•”νΈν™”λμ–΄ λ‚΄μ© ν•΄λ… λ¶κ°€")
        
        print("\nπ•µοΈ μ¤‘κ°„μ κ³µκ²©(MITM):")
        print("   HTTP       : β νΈλν”½ κ°€λ΅μ±„κΈ° λ° λ³€μ΅° μ„±κ³µ")
        print("   HTTPS/TLS  : β… μΈμ¦μ„ κ²€μ¦μΌλ΅ κ³µκ²© νƒμ§€")
        
        print("\nπ›΅οΈ TLS λ³΄μ• λ©”μ»¤λ‹μ¦:")
        print("   1. λ°μ΄ν„° μ•”νΈν™”: AES-256-GCM λ“± κ°•λ ¥ν• μ•”νΈν™”")
        print("   2. μ„λ²„ μΈμ¦: X.509 μΈμ¦μ„λ΅ μ„λ²„ μ‹ μ› ν™•μΈ")
        print("   3. λ¬΄κ²°μ„± λ³΄μ¥: HMACμΌλ΅ λ°μ΄ν„° λ³€μ΅° νƒμ§€")
        print("   4. μ „μ†΅ λ³΄μ•: λ„¤νΈμ›ν¬ λ λ²¨μ—μ„ μ™„μ „ν• λ³΄νΈ")
        
        print("\nπ’΅ ν•µμ‹¬ κµν›:")
        print("   - κ³µκ²©μλ” μ—¬μ „ν νΈλν”½μ„ μΊ΅μ²ν•  μ μλ‹¤")
        print("   - ν•μ§€λ§ TLS μ•”νΈν™”λ΅ λ‚΄μ©μ„ λ³Ό μ μ—†λ‹¤")
        print("   - μΈμ¦μ„ κ²€μ¦μΌλ΅ κ°€μ§ μ„λ²„λ¥Ό νƒμ§€ν•λ‹¤")
        print("   - μ „μ†΅ λ λ²¨ λ³΄μ• = μ• ν”λ¦¬μΌ€μ΄μ… μΈμ¦κ³Ό λ³„κ°")
        print("   - HTTP κ³µκ²©μ΄ HTTPSμ—μ„λ” λ¨λ‘ λ¬΄λ ¥ν™”λλ‹¤")

# ===========================================
# λ©”μΈ μ‹¤ν–‰ ν•¨μ
# ===========================================

def main():
    """
    λ©”μΈ μ‹¤ν–‰ ν•¨μ

    μ‹¤ν–‰ μμ„:
    1. μ¤λ‹ν•‘ λ°©μ–΄ ν…μ¤νΈ
    2. MITM λ°©μ–΄ ν…μ¤νΈ
    3. λ°©μ–΄ ν¨κ³Ό μ”μ•½

    μ‚¬μ „ μ¤€λΉ„:
    - HTTPS μ„λ²„κ°€ μ‹¤ν–‰ μ¤‘μ΄μ–΄μ•Ό ν•¨
    - 8443 (μμ FastMCP) λλ” 8444 (ν•μ΄λΈλ¦¬λ“) ν¬νΈ

    μ‹¤ν–‰ λ°©λ²•:
    python3 secure_attack_simulation.py

    λλ” Docker ν™κ²½:
    make shell python3 Part2_SSL/With_TLS/secure_attack_simulation.py

    κΈ°λ€ κ²°κ³Ό:
    - μ¤λ‹ν•‘ κ³µκ²© μ‹¤ν¨ (λ°μ΄ν„° μ•”νΈν™”λ¨)
    - MITM κ³µκ²© νƒμ§€ (μΈμ¦μ„ κ²€μ¦)
    - HTTP κ³µκ²©μ΄ HTTPSμ—μ„ λ¬΄λ ¥ν™”λ¨μ„ ν™•μΈ
    """
    print("π”’ TLS μ•”νΈν™” λ°©μ–΄ ν¨κ³Ό μ‹μ—°")
    print("=" * 60)
    print("HTTP κ³µκ²©μ΄ TLSλ΅ μ–΄λ–»κ² λ°©μ–΄λλ”μ§€ ν™•μΈν•©λ‹λ‹¤.")
    print("μ΄ μμ λ” μμ μ „μ†΅ λ λ²¨ λ³΄μ•(Transport Layer Security)μ— μ§‘μ¤‘ν•©λ‹λ‹¤.")

    # μ‹μ—° κ°μ²΄ μƒμ„±
    demo = SSLDefenseDemo()

    try:
        # 1. μ¤λ‹ν•‘ λ°©μ–΄ ν…μ¤νΈ
        demo.test_sniffing_defense()

        # 2. MITM λ°©μ–΄ ν…μ¤νΈ
        demo.test_mitm_defense()

        # 3. μ”μ•½
        demo.show_defense_summary()

    except KeyboardInterrupt:
        print("\nπ›‘ μ‹μ—°μ΄ μ¤‘λ‹¨λμ—μµλ‹λ‹¤.")
    except Exception as e:
        print(f"\nβ μ¤λ¥ λ°μƒ: {e}")

# ===========================================
# ν”„λ΅κ·Έλ¨ μ§„μ…μ 
# ===========================================

if __name__ == "__main__":
    """
    μ¤ν¬λ¦½νΈκ°€ μ§μ ‘ μ‹¤ν–‰λ  λ•λ§ λ©”μΈ ν•¨μ μ‹¤ν–‰

    κµμ΅ λ©μ :
    - HTTP vs HTTPS λ³΄μ• μ°¨μ΄ ν™•μΈ
    - TLS λ°©μ–΄ ν¨κ³Ό μ²΄ν—
    - λ³΄μ• μ„¤μ •μ μ¤‘μ”μ„± μ΄ν•΄

    λΉ„κµ ν•™μµ:
    1. No_TLS/attack_simulation.py μ‹¤ν–‰ (HTTP κ³µκ²© μ„±κ³µ)
    2. μ΄ νμΌ μ‹¤ν–‰ (HTTPS κ³µκ²© μ‹¤ν¨)
    3. λ‘ κ²°κ³Ό λΉ„κµ λ° λ¶„μ„
    """
    main()


# ===========================================
# ν•™μµ μ •λ¦¬
# ===========================================
"""
μ΄ νμΌμ—μ„ λ°°μ΄ λ‚΄μ©:

1. TLS μ•”νΈν™”μ λ°©μ–΄ ν¨κ³Ό

   μ¤λ‹ν•‘ λ°©μ–΄:
   - HTTP: ν¨ν‚·μ—μ„ λΉ„λ°€λ²νΈκ°€ ν‰λ¬ΈμΌλ΅ λ³΄μ„
   - HTTPS: ν¨ν‚·μ΄ μ•”νΈν™”λμ–΄ λ‚΄μ© μ• μ μ—†μ
   - TLS ν•Έλ“μ…°μ΄ν¬λ΅ μ•”νΈν™” ν‚¤ κµν™
   - AES-256-GCM λ“± κ°•λ ¥ν• μ•”νΈν™”

   μ‹¤μ  κ³µκ²© μ‹λ‚λ¦¬μ¤:
   - κ³µκ²©μκ°€ Wiresharkλ΅ ν¨ν‚· μΊ΅μ²
   - HTTP: "admin", "password" ν‰λ¬Έ λ°κ²¬
   - HTTPS: μ•”νΈν™”λ λ°”μ΄νΈλ§ λ³΄μ„
   - λ³µνΈν™” ν‚¤ μ—†μ΄λ” ν•΄λ… λ¶κ°€λ¥

2. TLS μΈμ¦μ„ κ²€μ¦ λ©”μ»¤λ‹μ¦

   verify=True (μ•μ „ν• μ„¤μ •):
   - CA μΈμ¦μ„λ΅ μ„λ²„ μΈμ¦μ„ κ²€μ¦
   - μΈμ¦μ„ μ²΄μΈ κ²€μ¦
   - λ§λ£ λ‚ μ§ ν™•μΈ
   - λ„λ©”μΈ μ΄λ¦„ μΌμΉ ν™•μΈ
   - MITM κ³µκ²© νƒμ§€

   verify=False (μ„ν—ν• μ„¤μ •):
   - λ¨λ“  μΈμ¦μ„ μλ½
   - MITM κ³µκ²©μ— λ…Έμ¶
   - κ°λ°/ν…μ¤νΈμ©μΌλ΅λ§ μ‚¬μ©
   - ν”„λ΅λ•μ… ν™κ²½μ—μ„ μ λ€ κΈμ§€

3. MITM κ³µκ²© λ°©μ–΄

   κ³µκ²© μ‹λ‚λ¦¬μ¤:
   1. κ³µκ²©μκ°€ λ„¤νΈμ›ν¬ μ¤‘κ°„μ— ν”„λ΅μ‹ μ„¤μΉ
   2. ν”Όν•΄μ νΈλν”½μ„ ν”„λ΅μ‹λ΅ μ°ν
   3. ν”„λ΅μ‹κ°€ κ°€μ§ μΈμ¦μ„ μ κ³µ
   4. ν΄λΌμ΄μ–ΈνΈκ°€ μΈμ¦μ„ κ²€μ¦μΌλ΅ νƒμ§€

   λ°©μ–΄ λ©”μ»¤λ‹μ¦:
   - TLS μΈμ¦μ„ κ²€μ¦
   - CA μ„λ… ν™•μΈ
   - κ³µκ° ν‚¤ μΈν”„λΌ (PKI)
   - κ°€μ§ μ„λ²„ νƒμ§€ λ° μ°¨λ‹¨

4. HTTP vs HTTPS λ³΄μ• λΉ„κµ

   λ„¤νΈμ›ν¬ μ¤λ‹ν•‘:
   - HTTP: μ™„μ „ λ…Έμ¶
   - HTTPS: μ•”νΈν™”λ΅ λ³΄νΈ

   MITM κ³µκ²©:
   - HTTP: κ³µκ²© μ„±κ³µ
   - HTTPS: μΈμ¦μ„ κ²€μ¦μΌλ΅ μ°¨λ‹¨

   λ°μ΄ν„° λ¬΄κ²°μ„±:
   - HTTP: λ³€μ΅° κ°€λ¥
   - HTTPS: HMACμΌλ΅ λ³€μ΅° νƒμ§€

   μ„λ²„ μΈμ¦:
   - HTTP: μΈμ¦ μ—†μ
   - HTTPS: μΈμ¦μ„λ΅ μ‹ μ› ν™•μΈ

5. TLS λ³΄μ• λ©”μ»¤λ‹μ¦

   λ°μ΄ν„° μ•”νΈν™”:
   - λ€μΉ­ ν‚¤ μ•”νΈν™” (AES-256-GCM)
   - λΉ„λ€μΉ­ ν‚¤ μ•”νΈν™” (RSA 2048/4096)
   - Perfect Forward Secrecy (PFS)
   - μ„Έμ… ν‚¤ μ •κΈ° κ°±μ‹ 

   μ„λ²„ μΈμ¦:
   - X.509 μΈμ¦μ„
   - CA μ„λ… κ²€μ¦
   - κ³µκ° ν‚¤ μ•”νΈν™”
   - λ„λ©”μΈ μ†μ κ¶ ν™•μΈ

   λ¬΄κ²°μ„± λ³΄μ¥:
   - HMAC (Hash-based MAC)
   - λ””μ§€ν„Έ μ„λ…
   - λ©”μ‹μ§€ λ³€μ΅° νƒμ§€
   - μ¬μƒ κ³µκ²© λ°©μ§€

6. μ‹¤μ  κ³µκ²© λ„κµ¬μ™€ λ°©μ–΄

   κ³µκ²© λ„κµ¬:
   - Wireshark: ν¨ν‚· λ¶„μ„
   - tcpdump: ν¨ν‚· μΊ΅μ²
   - mitmproxy: MITM ν”„λ΅μ‹
   - Burp Suite: μ›Ή ν”„λ΅μ‹
   - Ettercap: ARP μ¤ν‘Έν•‘

   λ°©μ–΄ λ©”μ»¤λ‹μ¦:
   - TLS 1.3 μ‚¬μ©
   - κ°•λ ¥ν• μ•”νΈν™” μ¤μ„νΈ
   - HSTS (HTTP Strict Transport Security)
   - Certificate Pinning
   - μΈμ¦μ„ ν¬λ…μ„± (CT)

7. μ „μ†΅ λ λ²¨ λ³΄μ• vs μ• ν”λ¦¬μΌ€μ΄μ… λ³΄μ•

   μ „μ†΅ λ λ²¨ (TLS):
   - λ„¤νΈμ›ν¬ κ³„μΈµ μ•”νΈν™”
   - λ¨λ“  λ°μ΄ν„° λ³΄νΈ
   - μ¤λ‹ν•‘/MITM λ°©μ–΄
   - μ΄ νμΌμ—μ„ λ‹¤λ£Έ

   μ• ν”λ¦¬μΌ€μ΄μ… λ λ²¨:
   - μΈμ¦/μΈκ°€
   - μ„Έμ… κ΄€λ¦¬
   - μ…λ ¥ κ²€μ¦
   - λ³„λ„λ΅ ν•„μ”ν•¨

   μ¤‘μ”: λ‘ λ λ²¨ λ¨λ‘ ν•„μ”!
   - TLSλ” μ „μ†΅ λ³΄μ•
   - μ• ν”λ¦¬μΌ€μ΄μ… λ³΄μ•μ€ λ³„λ„
   - λ‘ λ‹¤ κµ¬ν„ν•΄μ•Ό μ™„μ „ν• λ³΄μ•

8. μΈμ¦μ„ κ²€μ¦ μ„¤μ •

   ν”„λ΅λ•μ… ν™κ²½:
   requests.get(url, verify=True)  # ν•„μ!
   - CA μΈμ¦μ„ κ²€μ¦
   - μ•μ „ν• ν†µμ‹  λ³΄μ¥
   - MITM κ³µκ²© λ°©μ–΄

   κ°λ°/ν…μ¤νΈ ν™κ²½:
   requests.get(url, verify=False)  # μ£Όμ!
   - μμ²΄ μ„λ… μΈμ¦μ„ ν—μ©
   - λ³΄μ• κ²½κ³  λ¬΄μ‹
   - ν…μ¤νΈ λ©μ μΌλ΅λ§ μ‚¬μ©

   μ»¤μ¤ν…€ CA:
   requests.get(url, verify='/path/to/ca.crt')
   - μ‚¬μ„¤ CA μ‚¬μ©
   - λ‚΄λ¶€ λ„¤νΈμ›ν¬
   - μ—”ν„°ν”„λΌμ΄μ¦ ν™κ²½

9. λ³΄μ• λ¨λ²” μ‚¬λ΅€

   μΈμ¦μ„ κ΄€λ¦¬:
   - Let's Encrypt μλ™ κ°±μ‹ 
   - μΈμ¦μ„ λ§λ£ λ¨λ‹ν„°λ§
   - μ—¬λ¬ λ„λ©”μΈ μ§€μ› (SAN)
   - μΈμ¦μ„ λ°±μ—…

   TLS μ„¤μ •:
   - TLS 1.2 μ΄μƒ μ‚¬μ©
   - TLS 1.0/1.1 λΉ„ν™μ„±ν™”
   - κ°•λ ¥ν• μ•”νΈν™” μ¤μ„νΈ
   - Forward Secrecy ν™μ„±ν™”

   λ¨λ‹ν„°λ§:
   - TLS Labs ν…μ¤νΈ
   - μΈμ¦μ„ ν¬λ…μ„± λ΅κ·Έ
   - λ³΄μ• ν—¤λ” ν™•μΈ
   - μ·¨μ•½μ  μ¤μΊ”

10. μ‹¤μµ λ° λΉ„κµ

    μ‹¤μµ μμ„:
    1. No_TLS/attack_simulation.py μ‹¤ν–‰
       - HTTP κ³µκ²© μ„±κ³µ ν™•μΈ
       - λΉ„λ°€λ²νΈ ν‰λ¬Έ λ…Έμ¶
       - MITM κ³µκ²© μ„±κ³µ

    2. With_TLS/secure_attack_simulation.py μ‹¤ν–‰
       - HTTPS κ³µκ²© μ‹¤ν¨ ν™•μΈ
       - λ°μ΄ν„° μ•”νΈν™” ν™•μΈ
       - MITM κ³µκ²© νƒμ§€

    3. κ²°κ³Ό λΉ„κµ:
       - HTTP: λ¨λ“  κ³µκ²© μ„±κ³µ
       - HTTPS: λ¨λ“  κ³µκ²© μ‹¤ν¨
       - TLSμ λ°©μ–΄ ν¨κ³Ό μ²΄κ°

    ν•™μµ ν¬μΈνΈ:
    - HTTPλ” μ„ν—ν•λ‹¤
    - HTTPSλ” ν•„μλ‹¤
    - μΈμ¦μ„ κ²€μ¦μ€ μ¤‘μ”ν•λ‹¤
    - verify=Falseλ” μ„ν—ν•λ‹¤

ν•µμ‹¬ λ©”μ‹μ§€:
TLSμ€ μ „μ†΅ λ λ²¨μ—μ„ κ°•λ ¥ν• λ³΄μ•μ„ μ κ³µν•©λ‹λ‹¤.
λ„¤νΈμ›ν¬ μ¤λ‹ν•‘κ³Ό MITM κ³µκ²©μ„ ν¨κ³Όμ μΌλ΅ λ°©μ–΄ν•λ©°,
λ¨λ“  μ›Ή μ„λΉ„μ¤λ” λ°λ“μ‹ HTTPSλ¥Ό μ‚¬μ©ν•΄μ•Ό ν•©λ‹λ‹¤.
ν•μ§€λ§ TLSλ§μΌλ΅λ” μ¶©λ¶„ν•μ§€ μ•μΌλ©°,
μ• ν”λ¦¬μΌ€μ΄μ… λ λ²¨ λ³΄μ•λ„ ν•¨κ» κµ¬ν„ν•΄μ•Ό ν•©λ‹λ‹¤!
"""